# 데이터 분석

## **통계 분석**

### 통계 분석 개요
- Population, Parameter, Sample, Static
    - 모집단(Population) : 잘 정의된 연구목적
    - 모수(Parameter) : 모집단의 특성 수치,평균,분산
    - 표본(Sample) : 모집단에 추출,오차 발생
    - 통계량(Static) : 모수 특성 수치

### 표본추출
- 확률적 표본추출법의 종류
    - 단순 무작위 추출 : 동일한 확률로 추출(n/N)
    - 계통추출 : 일정 간격으로 추출(1,11,21,31...)
    - 층화추출 : **모집단을 서로 겹치지 않게** 몇 개의 집단 층(층,성별,지역 등)
    - 군집추출 : 차이가 없는 여러개 집단(경상대학 내 경영학과 경제학과내 경영학과 추출)

### **척도의 종류**
- 명목척도 : 특성을 분류하거나 확인(성별,혈액형,출생지 등)
- 서열척도(순서척도) : 순위만 제공할 뿐 양적인 비교 X, 항목들 간 서열,순위 존재(금,은,동,선호도 등)
- 등간척도(구간척도) : 순위를 부여하되 순위 사이의 간격이 동일,절대 0점이 존재하지 않음(온도계 수치,물가지수)
- 비율척도 : 절대0점이 존재(몸무게,나이,형제의 수)
    * 참조 : 연속형 자료를 나타내는 척도는 등간/비율척도 존재

### 집중화 경향 측정
- 집중화 경향 측정에 사용되는 값
    - 평균 : 산술 평균
    - 중앙값 : 평균
    - 최빈값 : 빈도 높은 값
    - Negative-Skewed(Mean<Median<Mode) / Symmetric / Positive-Skewed(Mean>Median>Mode)
- 산포도 : 산포도가 크면 변량들이 멀리 흩어짐,변동성 큼/
- 편차 : 편차의 총합은 항상 0, 변량에서 평균을 뺀 값
- 분산 : 편차의 제곱의 합 n-1 나눈 값(데이터 집합이 얼마나 퍼져 있는가)
- 표준편차(STD) : 분산의 제곱근

### 변동 계수(CV) : 평균/표준편차(ex)누가 꾸준히 공부했는가?)
### 통계 기본용어
- 표본점 : 주사위 1~6까지 중 하나
- 표본공간 : 모든 표본점의 집합
- 사건 : 표본점의 특정한 집합(주사위의 홀수)
- 확률 : 사건이 일어날 가능성(사건/표본공간=P(A))

### 사건의 종류 
- 독립사건 : A|B 의 확률 연관 X(P(B|A)=P(B), P(A|B)=P(A), P(A∩B)= P(A)*P(B))
- 배반사건 : 교집합이 공집합(A∩B= 0, P(A∪B)=P(A)+P(B))
- 종속사건 : A|B 확률 연관 ㅇ(P(A∩B)=P(A|B)*P(B))
### 조건부확률
- 조건부확률 : 사건 B가 발생했다는 조건 하에서 사건 A가 발생할 조건부 확률 (P(A|B)=P(A∩B) / P(B), 단 P(B)>0)
### 확률분포
- 분포 : 일정한 범위 안에 흩어져 있는 정도
- 확률변수 : 결과값이 확률적으로 정해지는 변수(Random variable)
- 확률분포 : 모든 값들과 그 값을 취할 확률
- 기댓값 : 확률변수 X의 가능한 모든 값들의 가중 평균
![graph](./img/expect.png)
    - 이산형 확률분포 : DISCRETE(한정된) 가능한 값을 가지는 분포(각 사건은 서로 독립)EX) 이항분포,베르누이분포,기하분포,포아송분포등
        - 베르누이분포 : 시행 결과 값 0 또는 1 을 가지는 분포 ex) 동전 앞,뒤/주사위를 던죠 4가 나올 확률
        - 이항분포 : 서로 독립된 **베르누이 시행을 n회 반복**하는 것. 기댓값 E(x) = np, 분산 V(x)=np(1-p)
        - 기하분포 : 베르누이 시행에서 **처음 성공**까지 시도한 X의 분포 (1-p(성공확률))^(처음 성공시도값x-1) * p(성공확률) 
        - 포아송분포 : **단위 시간이나 단위 공간**에서 어떤 사건이 몇 번 발생할 것인지 표현하는 분포
        ![graph](./img/Poisson.png)
    - 연속형 확률분포 : CONTINUOUS(연속된) 값을 가지는 분포 EX) 정규분포,지수분포,연속균일분포,카이제곱분포,F분포 등
    ![graph](./img/Continuos.png)
        - 정규분포 : 가우스 분포,평균0,표준편차/분산 1인 분포 Ex) 키,몸무게,시험점수
            - 확률 밀도 함수 : 특정 구간에 속할 확률을 계산하기 위한 함수
            - 3 시그마 규칙 : 평균+-1표준편차(68.27%),평균+-2표준편차(95.45%),평균+-3표준편차(99.73%),그 이외의 값을 이상치 표현
            - 정규분포의 당위성 : 이항분포의 근사(시행횟수가 커지면 정규분포와 비슷),중심 극한 정리(표본평균은 표본의 크기가 크면 정규분포 비슷), 오차의 법칙(MLE이 측정값의 평균이면 정규분포와 비슷)
        - 균등분포
            - 이상균등분포 : 모든 곳에서 값이 일정
            - 연속균등분포 : 매개변수 a,b 사이에서 균등
        - 지수분포 : 사건이 서로 독립적일때, 다음 사건이 일어날 때까지 대기시간
        - t분포 : 표본이 많이 없을떄 대응책,신뢰구간,가설검정에 사용
        - x^2분포(카이제곱분포) : 분산의 특징을 확률분포로 만든 것,자유도(v)+카이제곱분포(x^2)
        - F분포 : 분산의 특징으로 확률 분포, 카이제곱 분포는 한 집단의 분포,F분포는 2집단의 분산,두 집단의 분산이 크기가 서로 같은지 또는 다른지 비교

### 통계적 추론의 분류
- 모집단에 대한 가정 여부에 따른 추론의 분류
    - 모수적추론 : 모집단에 특정 분포를 가정하고 모수에 대한 추론
    - 비모수적 추론 : 모집단에 대해 특정 분포 가정X
- 추론 목적에 다른 통계적 추론의 분류
    - 추정: 통계량을 사용하여 모집단의 모수를 구체적으로 추측
        - 점추정 : 하나의 값으로 모수의 값 추측
            - 적률법 : 기대값을 통해 모수를 추정
            - 최대가능도추정법 : 함수를 미분해서 기울기가 0인 위치에 존재
            - 최소제곱법 : 함수값과 측정값의 차이인 오차를 제곱한 합이 최소가 되는 함수
        - 구간추정 : 모수를 포함할 것으로 기대되는 구간을 확률적으로 추측, 점추정의 정확성 보완
            - 신뢰구간 : '범위'
            - 신뢰수준 : 모수값을 포함하는 신뢰구간이 존재할 확률
    - 가설검정 : 모수에 대한 가설을 세우고 확률적 판정
- 모수처리방식에 따른 통계적 추론 본류
    - Frequentist
    - Bayesian

### 표준편차
- 표준편차 : 자료가 평균을 중심으로 얼마나 퍼져있는지, 편차(관측갑-평균)
- 표준오차 : 한 표본에서 전체 개체가 가지는 값들의 차이, 오차(추정값-참값)
- 오차한계 : 최대허용오차

### 추정량
- 표본의 통계량을 가지고 모집단의 모수를 추측하여 결정
- 추정량 판단기준
    - 일치성 : 표본의 크기가 커짐에 따라 표본 오차가 작아야함
    - 비편향성,불편성 : 편향 = 추정량의 기댓값 - 실제값 = 0
    - 효율성 : 추정량의 분산이 될수 있는대로 작아야함.

### 가설검정
- 귀무가설 : 부정하고자 하는 가설(용의자 무죄)
- 대립가설 : 연구자가 연구를 통해 입증 또는 증명되기를 기대하는 예상이나 주장(용의자 유죄)
- 기각역 : 점정통계량(t-value)의 부분에서 유의수준의 크기에 해당되는 영역, 귀무가설을 기각하는 통계량의 영역
- 오류

    - 1종 오류 : 귀무가설이 참인데 기각하는 오류
    - 2종 오류 : 귀마가설이 거짓인데 채택하는 오류
    - 유의수준 : 제 1종 오류의 최대 허용한계 EX) 유의 수준 5% : 100번 실험에서 1종 오류 범하는 최대 호용 한계 5번
    - 유의확률(P-VALUE) : 1종 오류 확률, P-VALUE < 유의수준(알파) 귀무가설을 기각, 대립가설을 채택, 우리가 내린 판정이 잘못되었을 확률
- 귀무 가설을 이용한 가설 검증 프로세스
    - 귀무가설 대립가설 가정 -> 실험 수행 -> 귀무가설로 결과 해석 불가 -> 귀무가설 기각 -> 대립가설 채택

### 모수적,비모수적 추론
![graph](./img/모수,비모수적 추론.png)
- 모수적 추론 : 모집단에 특정 분포를 가정,모수에 대해 추론하는 방법, 자료가 정규분포,등간척도,비율척도 (표분개수(N) > 30, 10 <= N <= 30
    - 모수적 검정 : **표본 평균,표본 분산**등을 이용해 검정
        - 전재조건 : 정규분포,분산 동일, 등간척도나 비율척도로 측정
        - 검정방법 : t TEST, Paired T test, ANVOA, Z분포, t분포, f분포, 카이스퀘어 분포
            - **t Test** : 평균,평균 차이 여부를 검증
                - One Sample t-test : 평균 검정
                ![graph](./img/one sample t-test.png)
                - Paired t-test : 처리 전/후 값 ex) A,B 약 투약후 결과
                ![graph](./img/paired sample t-test.png)
                - Two Sample t-test : 서로 다른 그룹
                ![graph](./img/two sample t-test.png)
        - 검정방법 사용예
            - 모평균과 표본평균의 차이 : z분포, t분포
            - 표본평균간의 차이 : z분포, t분포
            - 모분산과 표본분의 차이 : f분포,카이제곱분포
            - 표본분간의 차이, F분포,카이제곱분포
- 비모수적 추론 : 모집단에 대해 특정 분포가정 x, 분포 형태에 대한 검정, 포본수가 적고, 명목척도, 서열척도인 경우 (표분개수(N) < 30, 10 <= N <= 30), **분포 형태에 따른 추론**
    - 검정종류 : 
        - 명목 척도 : **카이스퀘어 검정**, 등
            - **카이스퀘어 검정** : 적합도 검정(그룹별 비율),동질성 검정(유사),독립성 검정(독립)
        - 서열 척도 : **Sign Test**, 등
            - **Sign Test** : 두개의 분포 차이가 있는가에 대한 가설 검증

### 데이터의 정규성 검정
- 검정 종류 : Q-Q plot,Histogram,Shapiro Wilk test,Kolomogorov-Smirnov test
    - Q-Q plot : 시각적으로 확인 가능
    - Histogram :
    - Shaprio-Wilk test : p-value가 0.05보다 크면 정규성을 가정
    - Kolmogorov-Smironov test : p-value가 0.05보다 크면 정규성을 가정

### 참조자료
![graph](./img/R의기초통계.png)

### 회귀분석(lm(종속변수~독립변수,data))
![graph](./img/회귀모형분석.png)
- 용어 정리
    - 독립변수 : 다른 변수에 영향을 받지 않고, 독립적으로 변화하는 수
    - 종속변수 : 독립변수의 영향을 받아 값이 변화하는 수
    - 잔차(오차항) : 이론값과 실제 값의 차이, 모집단 = 오차, 표본집단 = 잔차 라고 부름
- 회귀 분석 : 변수와 변수 사이의 관계를 알아보기 위함, 연속형 변수일떄 가능
    - 이산형 : 명목, 서열 척도
    - 연속형 : 구간, 비율 척도
- 선형 회귀 : 종속 변수 y 와 독립변수 X와의 선형 상관 관계
    - 단순선형회귀분석
        - 최소자승법 : (측정값- 함수값)^2 최소
    - 다중회귀 모형
- 조건
    - 선형성 : 선형 모형
    - 독립성 : 독립변수의 값이 관련X
    - 정상성 : 정규분포
    - 등분산성 : 동일한 분산
    - 비상관성 : 잔차들끼리 상관X
- 판단
    - Normal Q-Q plot : 정규성 판단
    - Scale-Location : 등분산성
    - Cook's Distance : 관측치를 영향점으로 판단
    - Residual vs Fitted : 분산이 일정한 정규분포
- 회귀모형 해석
    - 모형이 통계적으로 유의미? : F통계량, 유의확률(p-value)
    - 회귀계수들이 유의미 : 회귀계수 t, 유의확률(p-value)
    - 설명력 : 결정계수(R^2)
    - 데이터 적합 : 잔차 통계량 확인, 회귀진단 진행(선형성 ~ 정상성)
    - F 통계량,p-Value
        - 회귀제곱평균(MSR) / 잔차제곱평균(MSE)
        - p-value < 0.05
    - t : 클수록 회귀계수가 유의미
        - t값 = 회귀계수 / 표준오차
        - p-value < 0.05
    - 결정계수
        - 회귀식의 적합도
        - 결정계수 = 회귀제곱합(SSR) / 총제곱합(SST), 1-(SSE/SST)
        - 결정계수가 1 가까울수록 설명력 높음

### 다중 공선성
- 문제 : 중대한 다중공선성은 회귀계수의 분산을 증가시켜 해석하기 어려움
- 해결방법 : 설명변수 제거, y에 영향을 주는 설명변수는 추가 
- 선택방법
    - 모든가능한 조합 : 모든 가능한 조합
    - 후진제거법 : 독립변수 후보 모두를 포함한 모형에서 출발
    - 전진선택법 : 절편만 있는 모델에서 출발
    - 단계별 선택법 
- 판단기준: Cp,AIC,BIC 가 작을수록 좋음
- 설명 변수 선택방법
    - 후진제거법 : direction = 'backward'
    - 후진제거법 : direction = 'forward'
    - 후진제거법 : direction = 'both'
![graph](./img/설명변수선택방법1.png)
![graph](./img/설명변수선택방법2.png)

### 과적합(OVerfitting)
- 문제 : 설명변수와 종속변수의 관계가 필요이상 너무 상세해서, 새로운 데이터가 주어졌을때 제대로 예측이 어려움
- 해결방법 : Feature 개수 Down, Regularization을 수행

### 정규화(Regularization)
- 베타값에 제약을 주어 모델에 변화를 주는 것
- 람다 값이 크면 Underfitting, 람다 값이 작으면 Overfitting
- L1,L2,Norm(벡터의 크기와 길이를 측정하는법)
    - L1 norm : 벡터의 모든 성분의 절대값을 더함
    - L2 norm : 출발점에서 도착점까지의 거리를 직선거리 측정
- Regularized Linear Regression
    - 라쏘 회귀 특징
        - 변수 선택이 가능
        - L1 Norm을 패널티를 가진 선형 회귀 방법, 회귀계수의 절댓값이 클수록 패널티 부여,W의 모든 원소가 0이되거나 0에 가깝게 되야함.
        - 장점 : 가장치들이 0이 되게함.
    - Ridge 회귀 특징
        - L2 norm 사용
        - 변수 선택이 불가능,Ridge의 가중치들은 0에 가까워질뿐 0이 되지는 않음.
    - 엘라스틱넷 특성
        - L1,L2 norm 사용
        - 변수선택 가능, 상관 관계를 반영

### 데이터 스케일링
- 데이터 단위의 불일치 문제를 해결하는 법
    - 정규화(normalization) : [0,1]로 변환
    - 표준화(standardization) : 정규분포를 갖도록 변환하는 것

## 상관관계를 이용하는 다변량 분석

### 상관 분석
- 상관 계수의 이해
    - 관련성의 정도
    - 피어슨 상관계수는 선형적인 크기만 측정 가능, 스피어만 상관계수는 비선형적인 관계도 나타냄
    - R의 cor.test()함수를 사용해 상관계수 검정 수행,유의성검정을 판단
    - 스피어만 상관계수
        - 서열척도 사용,비선형적인 관계
    - 피어슨 상관계수
        - 등간척도,비율척도 사용, 선형적인 크기만 측정 가능
    - 공분산 : 2개의 확률변수의 선형 관계를 나타내는 값

### 차원축소 목표를 위해 개발된 분석 방법
- 주성분분석(PCA)
    - 공분산행렬 또는 상관계수 행렬을 사용해 모든 변수들을 가장 잘 설명하는 주성분 찾는 방법
    - 분산을 극대화하는 변수
    - 공분산행렬 VS 상관계수행렬 
        - 공분산 측정단위 그대로 반영 prcomp(data,scale=TRUE)
        - 상관계수 행렬 모든 변수 측정단위 표준화 princomp(data,cor=TRUE)
    - 주성분 결정 기준
        - 성분들이 설명하는 분산의 비율(누적 분산비율이 70~90% 사이 주성분)
        - 고윳값 : 분산의 크기를 나타냄
        - Scree Plot : 고윳값을 가장 큰값에서 가장 작업 순서로 표현
![graph](./img/주성분분석.png)

- 군집분석

### 시계열 예측
- 시계열 자료
- 정상성 : 주기적 변동X
- 정상 시계열의 조건
    - 평균은 모든 시점에 대해 일정
    - 분산은 모든 시점에 대해 일정
    - 공분산은 시점에 의존X, 시차에만 의존
- 정상시계열 전환
    - 평균이 일정하지 않는 경우 :차분(현시점에서 전시점의 차) 사용
    - 계절성을 갖는 비정상 시계열 : 계절 차분
    - 분산이 일정하지 않는 경우 : 자연로그

### 시계열 모형
- AR 모형 자기회귀 모형
- MA 모형 이동 평균 모형 : 항상 정상성 만족
- ARIMA 모형 자기회귀 누적 이동평균 모형 : 비정상시계열 모형 ARIMA(p,d,q) p:AR모형차수, d:차분, q:MA 모형 차수 ex) ARIMA(1,2,3) 2번 차분하면 ARMA, ARIMA(1,0,2) ARMA(1,2) 모형이고, 1번 차분하면 MA(2), ARIMA(0,1,3) IMA(1,3) 모형이고 1번 차분하면 MA(3)

### ACF,PACF,White Noise
- 자기상관함수(ACF) : 시계열 데이터의 자기상관성을 파악하기 위한 함수
- 부분 자기 상관함수 : Yt,Yt-k 상이에 있는 값들은 제외시키고 Yt,Yt-k 직접적 상관관계
- 백색잡음 

### 분해 시계열
- 분햇기계열 분해 요인
    - 추세요인 : 형태가 오르거나 내리는
    - 계절요인 : 고정된 주기에 따라
    - 순환요인 : 알려지지 않은 주기를 가지는
    - 불규칙요인 : 불규칙